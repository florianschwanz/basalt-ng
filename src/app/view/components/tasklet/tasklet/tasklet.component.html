<div class="card-wrapper">
  <div class="top-attached" *ngIf="tasklet.type == 'Finishing Time'">
    {{ weekDay }}, {{ date }}
    <div class="top-connection-line"></div>
  </div>
  <mat-card>
    <mat-card-header (click)="onToggleExpansionPanel()">
      <mat-icon [svgIcon]=icon class="tasklet-type"></mat-icon>
      <span class="topic">{{ topic }}</span>
      <div class="flexbox"></div>
      <div class="project"
           [style.background-color]="projectColor"
           *ngIf="project != null && project.name != null && project.name !=''">
        {{ project.name }}
      </div>
    </mat-card-header>

    <mat-card-content>
      <mat-accordion class="headers-align" (click)="onActionFired('update')">
        <mat-expansion-panel [expanded]="expansionPanelOpened" hideToggle>
          <div class="text">
            <mat-list *ngIf="tasklet.description.value != null && tasklet.description.value.length > 0">
              <mat-list-item class="text" *ngFor="let item of tasklet.description.value.split('\n')">{{ item }}
              </mat-list-item>
            </mat-list>
          </div>
          <app-tasklet-daily-scrum [tasklet]="tasklet" (onActionFired)="onActionFired($event)"
                                   *ngIf="tasklet.type == 'Daily Scrum'">
          </app-tasklet-daily-scrum>
          <app-tasklet-participants [tasklet]="tasklet" (onActionFired)="onActionFired($event)"
                                    *ngIf="tasklet.type == 'Meeting'
                                       || tasklet.type == 'Call'
                                       || tasklet.type == 'Mail'
                                       || tasklet.type == 'Chat'">
          </app-tasklet-participants>
          <app-tasklet-daily-digest [tasklet]="tasklet" (actionFiredEmitter)="onActionFired($event)"
                                    *ngIf="tasklet.type == 'Finishing Time'">
          </app-tasklet-daily-digest>
          <app-tasklet-weekly-digest [tasklet]="tasklet" (actionFiredEmitter)="onActionFired($event)"
                                     *ngIf="tasklet.type == 'Weekly Digest'">
          </app-tasklet-weekly-digest>
        </mat-expansion-panel>
      </mat-accordion>
      <hr class="delimiter"/>
      <span class="tag" *ngFor="let t of tasklet.tags">
      <label class="tag-label">{{ t.name }}</label>
    </span>
    </mat-card-content>
    <mat-card-footer>
      <div class="attachments">
        <div class="attachment-holder">
          <div *ngIf="tasklet.creationDate != null" class="side-attached left-attached"
               (click)="onActionFired('updateTime')"
               [matTooltip]=date
               matTooltipPosition="above">
            <span class="left-attached-content" *ngIf="dateService.isBeforeToday(tasklet.creationDate)">{{ weekDay.slice(0, 3) }},</span>
            <span class="left-attached-content">{{ time }}</span>
          </div>
        </div>
        <div class="flexbox"></div>
        <div class="attachment-holder">
          <div *ngIf="tasklet.type == 'Action'
                                       || tasklet.type == 'Meeting'
                                       || tasklet.type == 'Call'
                                       || tasklet.type == 'Development'
                                       || tasklet.type == 'Debugging'
                                       || tasklet.type == 'Idea'
                                       || tasklet.type == 'TODO' "
               class="side-attached right-attached" (click)="onActionFired('continue')"
               matTooltip="Continue with tasklet"
               matTooltipPosition="above">
            <div class="right-attached-content">
              <mat-icon class="continue-icon" svgIcon="play_circle_filled"></mat-icon>
            </div>
          </div>
          <div *ngIf="tasklet.type == 'Daily Scrum'" class="side-attached right-attached hidden"
               (click)="onActionFired('template')" matTooltip="Template this event" matTooltipPosition="above">
            <mat-icon class="continue-icon" svgIcon="play_circle_filled"></mat-icon>
          </div>
        </div>
      </div>
    </mat-card-footer>
  </mat-card>
</div>
